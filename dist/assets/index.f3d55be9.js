import{i as He,a as We,b as J,d as R,m as re,c as Pe,e as M,f as _e,g as Ye,s as Ke,u as Ne,h as G,j as Ze,r as W,k as Ge,l as ie,n as T,w as ue,o as Je,p as Qe,q as m,t as z,v as b,x as C,y as S,z as p,A as e,B as H,C as K,D as _,E as P,F as me,G as L,H as fe,I as et,J as tt,K as st,L as ve,M as Ue,N as at,O as nt,P as De,Q as ot,R as lt,S as O,T as rt,U as it,_ as te,V as le,W as ee,X as ut,Y as ge,Z as dt,$ as Be,a0 as ct,a1 as Ae,a2 as ft,a3 as Ce,a4 as oe,a5 as ye,a6 as ze,a7 as N,a8 as Me,a9 as pt,aa as je,ab as mt,ac as vt,ad as gt,ae as yt,af as ht,ag as bt,ah as kt,ai as wt,aj as $t,ak as _t,al as Ct,am as Ee,an as Se,ao as Et,ap as Re,aq as St,ar as Rt,as as Lt,at as Tt,au as Ft,av as It,aw as Ot}from"./index.729ec0c4.js";import{d as Pt}from"./debounce.4098d8e5.js";var Nt="Expected a function";function ce(a,n,l){var t=!0,c=!0;if(typeof a!="function")throw new TypeError(Nt);return He(l)&&(t="leading"in l?!!l.leading:t,c="trailing"in l?!!l.trailing:c),Pt(a,n,{leading:t,maxWait:n,trailing:c})}const Ut=()=>We&&/firefox/i.test(window.navigator.userAgent),xe=Symbol("uploadContextKey"),Dt=J({urlList:{type:R(Array),default:()=>re([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),Bt={close:()=>!0,switch:a=>Pe(a)},At=["src"],zt=M({name:"ElImageViewer"}),Mt=M({...zt,props:Dt,emits:Bt,setup(a,{expose:n,emit:l}){const t=a,c={CONTAIN:{name:"contain",icon:_e(Ye)},ORIGINAL:{name:"original",icon:_e(Ke)}},v=Ut()?"DOMMouseScroll":"mousewheel",{t:w}=Ne(),h=G("image-viewer"),{nextZIndex:f}=Ze(),k=W(),y=W([]),F=Ge(),r=W(!0),s=W(t.initialIndex),o=ie(c.CONTAIN),u=W({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),$=T(()=>{const{urlList:g}=t;return g.length<=1}),d=T(()=>s.value===0),B=T(()=>s.value===t.urlList.length-1),i=T(()=>t.urlList[s.value]),U=T(()=>{const{scale:g,deg:E,offsetX:I,offsetY:j,enableTransition:q}=u.value;let x=I/g,X=j/g;switch(E%360){case 90:case-270:[x,X]=[X,-x];break;case 180:case-180:[x,X]=[-x,-X];break;case 270:case-90:[x,X]=[-X,x];break}const Q={transform:`scale(${g}) rotate(${E}deg) translate(${x}px, ${X}px)`,transition:q?"transform .3s":""};return o.value.name===c.CONTAIN.name&&(Q.maxWidth=Q.maxHeight="100%"),Q}),A=T(()=>Pe(t.zIndex)?t.zIndex:f());function D(){se(),l("close")}function V(){const g=ce(I=>{switch(I.code){case ee.esc:t.closeOnPressEscape&&D();break;case ee.space:ke();break;case ee.left:we();break;case ee.up:Y("zoomIn");break;case ee.right:$e();break;case ee.down:Y("zoomOut");break}}),E=ce(I=>{(I.wheelDelta?I.wheelDelta:-I.detail)>0?Y("zoomIn",{zoomRate:1.2,enableTransition:!1}):Y("zoomOut",{zoomRate:1.2,enableTransition:!1})});F.run(()=>{le(document,"keydown",g),le(document,v,E)})}function se(){F.stop()}function ae(){r.value=!1}function ne(g){r.value=!1,g.target.alt=w("el.image.error")}function Z(g){if(r.value||g.button!==0||!k.value)return;u.value.enableTransition=!1;const{offsetX:E,offsetY:I}=u.value,j=g.pageX,q=g.pageY,x=ce(Q=>{u.value={...u.value,offsetX:E+Q.pageX-j,offsetY:I+Q.pageY-q}}),X=le(document,"mousemove",x);le(document,"mouseup",()=>{X()}),g.preventDefault()}function be(){u.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ke(){if(r.value)return;const g=ut(c),E=Object.values(c),I=o.value.name,q=(E.findIndex(x=>x.name===I)+1)%g.length;o.value=c[g[q]],be()}function de(g){const E=t.urlList.length;s.value=(g+E)%E}function we(){d.value&&!t.infinite||de(s.value-1)}function $e(){B.value&&!t.infinite||de(s.value+1)}function Y(g,E={}){if(r.value)return;const{zoomRate:I,rotateDeg:j,enableTransition:q}={zoomRate:1.4,rotateDeg:90,enableTransition:!0,...E};switch(g){case"zoomOut":u.value.scale>.2&&(u.value.scale=Number.parseFloat((u.value.scale/I).toFixed(3)));break;case"zoomIn":u.value.scale<7&&(u.value.scale=Number.parseFloat((u.value.scale*I).toFixed(3)));break;case"clockwise":u.value.deg+=j;break;case"anticlockwise":u.value.deg-=j;break}u.value.enableTransition=q}return ue(i,()=>{Je(()=>{const g=y.value[0];g!=null&&g.complete||(r.value=!0)})}),ue(s,g=>{be(),l("switch",g)}),Qe(()=>{var g,E;V(),(E=(g=k.value)==null?void 0:g.focus)==null||E.call(g)}),n({setActiveItem:de}),(g,E)=>(m(),z(it,{to:"body",disabled:!g.teleported},[b(rt,{name:"viewer-fade",appear:""},{default:C(()=>[S("div",{ref_key:"wrapper",ref:k,tabindex:-1,class:p(e(h).e("wrapper")),style:H({zIndex:e(A)})},[S("div",{class:p(e(h).e("mask")),onClick:E[0]||(E[0]=K(I=>g.hideOnClickModal&&D(),["self"]))},null,2),_(" CLOSE "),S("span",{class:p([e(h).e("btn"),e(h).e("close")]),onClick:D},[b(e(P),null,{default:C(()=>[b(e(me))]),_:1})],2),_(" ARROW "),e($)?_("v-if",!0):(m(),L(fe,{key:0},[S("span",{class:p([e(h).e("btn"),e(h).e("prev"),e(h).is("disabled",!g.infinite&&e(d))]),onClick:we},[b(e(P),null,{default:C(()=>[b(e(et))]),_:1})],2),S("span",{class:p([e(h).e("btn"),e(h).e("next"),e(h).is("disabled",!g.infinite&&e(B))]),onClick:$e},[b(e(P),null,{default:C(()=>[b(e(tt))]),_:1})],2)],64)),_(" ACTIONS "),S("div",{class:p([e(h).e("btn"),e(h).e("actions")])},[S("div",{class:p(e(h).e("actions__inner"))},[b(e(P),{onClick:E[1]||(E[1]=I=>Y("zoomOut"))},{default:C(()=>[b(e(st))]),_:1}),b(e(P),{onClick:E[2]||(E[2]=I=>Y("zoomIn"))},{default:C(()=>[b(e(ve))]),_:1}),S("i",{class:p(e(h).e("actions__divider"))},null,2),b(e(P),{onClick:ke},{default:C(()=>[(m(),z(Ue(e(o).icon)))]),_:1}),S("i",{class:p(e(h).e("actions__divider"))},null,2),b(e(P),{onClick:E[3]||(E[3]=I=>Y("anticlockwise"))},{default:C(()=>[b(e(at))]),_:1}),b(e(P),{onClick:E[4]||(E[4]=I=>Y("clockwise"))},{default:C(()=>[b(e(nt))]),_:1})],2)],2),_(" CANVAS "),S("div",{class:p(e(h).e("canvas"))},[(m(!0),L(fe,null,De(g.urlList,(I,j)=>ot((m(),L("img",{ref_for:!0,ref:q=>y.value[j]=q,key:I,src:I,style:H(e(U)),class:p(e(h).e("img")),onLoad:ae,onError:ne,onMousedown:Z},null,46,At)),[[lt,j===s.value]])),128))],2),O(g.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var jt=te(Mt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const xt=ge(jt),Vt=J({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:a=>a>=0&&a<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:{type:Boolean,default:!1},duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:R(String),default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:R([String,Array,Function]),default:""},format:{type:R(Function),default:a=>`${a}%`}}),qt=["aria-valuenow"],Xt={viewBox:"0 0 100 100"},Ht=["d","stroke","stroke-width"],Wt=["d","stroke","opacity","stroke-linecap","stroke-width"],Yt={key:0},Kt=M({name:"ElProgress"}),Zt=M({...Kt,props:Vt,setup(a){const n=a,l={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},t=G("progress"),c=T(()=>({width:`${n.percentage}%`,animationDuration:`${n.duration}s`,backgroundColor:B(n.percentage)})),v=T(()=>(n.strokeWidth/n.width*100).toFixed(1)),w=T(()=>["circle","dashboard"].includes(n.type)?Number.parseInt(`${50-Number.parseFloat(v.value)/2}`,10):0),h=T(()=>{const i=w.value,U=n.type==="dashboard";return`
          M 50 50
          m 0 ${U?"":"-"}${i}
          a ${i} ${i} 0 1 1 0 ${U?"-":""}${i*2}
          a ${i} ${i} 0 1 1 0 ${U?"":"-"}${i*2}
          `}),f=T(()=>2*Math.PI*w.value),k=T(()=>n.type==="dashboard"?.75:1),y=T(()=>`${-1*f.value*(1-k.value)/2}px`),F=T(()=>({strokeDasharray:`${f.value*k.value}px, ${f.value}px`,strokeDashoffset:y.value})),r=T(()=>({strokeDasharray:`${f.value*k.value*(n.percentage/100)}px, ${f.value}px`,strokeDashoffset:y.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),s=T(()=>{let i;return n.color?i=B(n.percentage):i=l[n.status]||l.default,i}),o=T(()=>n.status==="warning"?dt:n.type==="line"?n.status==="success"?Be:ct:n.status==="success"?Ae:me),u=T(()=>n.type==="line"?12+n.strokeWidth*.4:n.width*.111111+2),$=T(()=>n.format(n.percentage));function d(i){const U=100/i.length;return i.map((D,V)=>Ce(D)?{color:D,percentage:(V+1)*U}:D).sort((D,V)=>D.percentage-V.percentage)}const B=i=>{var U;const{color:A}=n;if(ft(A))return A(i);if(Ce(A))return A;{const D=d(A);for(const V of D)if(V.percentage>i)return V.color;return(U=D[D.length-1])==null?void 0:U.color}};return(i,U)=>(m(),L("div",{class:p([e(t).b(),e(t).m(i.type),e(t).is(i.status),{[e(t).m("without-text")]:!i.showText,[e(t).m("text-inside")]:i.textInside}]),role:"progressbar","aria-valuenow":i.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[i.type==="line"?(m(),L("div",{key:0,class:p(e(t).b("bar"))},[S("div",{class:p(e(t).be("bar","outer")),style:H({height:`${i.strokeWidth}px`})},[S("div",{class:p([e(t).be("bar","inner"),{[e(t).bem("bar","inner","indeterminate")]:i.indeterminate}]),style:H(e(c))},[(i.showText||i.$slots.default)&&i.textInside?(m(),L("div",{key:0,class:p(e(t).be("bar","innerText"))},[O(i.$slots,"default",{percentage:i.percentage},()=>[S("span",null,oe(e($)),1)])],2)):_("v-if",!0)],6)],6)],2)):(m(),L("div",{key:1,class:p(e(t).b("circle")),style:H({height:`${i.width}px`,width:`${i.width}px`})},[(m(),L("svg",Xt,[S("path",{class:p(e(t).be("circle","track")),d:e(h),stroke:`var(${e(t).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-width":e(v),fill:"none",style:H(e(F))},null,14,Ht),S("path",{class:p(e(t).be("circle","path")),d:e(h),stroke:e(s),fill:"none",opacity:i.percentage?1:0,"stroke-linecap":i.strokeLinecap,"stroke-width":e(v),style:H(e(r))},null,14,Wt)]))],6)),(i.showText||i.$slots.default)&&!i.textInside?(m(),L("div",{key:2,class:p(e(t).e("text")),style:H({fontSize:`${e(u)}px`})},[O(i.$slots,"default",{percentage:i.percentage},()=>[i.status?(m(),z(e(P),{key:1},{default:C(()=>[(m(),z(Ue(e(o))))]),_:1})):(m(),L("span",Yt,oe(e($)),1))])],6)):_("v-if",!0)],10,qt))}});var Gt=te(Zt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/progress/src/progress.vue"]]);const Jt=ge(Gt),Qt="ElUpload";class es extends Error{constructor(n,l,t,c){super(n),this.name="UploadAjaxError",this.status=l,this.method=t,this.url=c}}function Le(a,n,l){let t;return l.response?t=`${l.response.error||l.response}`:l.responseText?t=`${l.responseText}`:t=`fail to ${n.method} ${a} ${l.status}`,new es(t,l.status,n.method,a)}function ts(a){const n=a.responseText||a.response;if(!n)return n;try{return JSON.parse(n)}catch{return n}}const ss=a=>{typeof XMLHttpRequest>"u"&&ye(Qt,"XMLHttpRequest is undefined");const n=new XMLHttpRequest,l=a.action;n.upload&&n.upload.addEventListener("progress",v=>{const w=v;w.percent=v.total>0?v.loaded/v.total*100:0,a.onProgress(w)});const t=new FormData;if(a.data)for(const[v,w]of Object.entries(a.data))Array.isArray(w)?t.append(v,...w):t.append(v,w);t.append(a.filename,a.file,a.file.name),n.addEventListener("error",()=>{a.onError(Le(l,a,n))}),n.addEventListener("load",()=>{if(n.status<200||n.status>=300)return a.onError(Le(l,a,n));a.onSuccess(ts(n))}),n.open(a.method,l,!0),a.withCredentials&&"withCredentials"in n&&(n.withCredentials=!0);const c=a.headers||{};if(c instanceof Headers)c.forEach((v,w)=>n.setRequestHeader(w,v));else for(const[v,w]of Object.entries(c))ze(w)||n.setRequestHeader(v,String(w));return n.send(t),n},Ve=["text","picture","picture-card"];let as=1;const pe=()=>Date.now()+as++,qe=J({action:{type:String,default:"#"},headers:{type:R(Object)},method:{type:String,default:"post"},data:{type:Object,default:()=>re({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},type:{type:String,default:"select"},fileList:{type:R(Array),default:()=>re([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:Ve,default:"text"},httpRequest:{type:R(Function),default:ss},disabled:Boolean,limit:Number}),ns=J({...qe,beforeUpload:{type:R(Function),default:N},beforeRemove:{type:R(Function)},onRemove:{type:R(Function),default:N},onChange:{type:R(Function),default:N},onPreview:{type:R(Function),default:N},onSuccess:{type:R(Function),default:N},onProgress:{type:R(Function),default:N},onError:{type:R(Function),default:N},onExceed:{type:R(Function),default:N}}),os=J({files:{type:R(Array),default:()=>re([])},disabled:{type:Boolean,default:!1},handlePreview:{type:R(Function),default:N},listType:{type:String,values:Ve,default:"text"}}),ls={remove:a=>!!a},rs=["onKeydown"],is=["src"],us=["onClick"],ds=["onClick"],cs=["onClick"],fs=M({name:"ElUploadList"}),ps=M({...fs,props:os,emits:ls,setup(a,{emit:n}){const{t:l}=Ne(),t=G("upload"),c=G("icon"),v=G("list"),w=W(!1),h=f=>{n("remove",f)};return(f,k)=>(m(),z(mt,{tag:"ul",class:p([e(t).b("list"),e(t).bm("list",f.listType),e(t).is("disabled",f.disabled)]),name:e(v).b()},{default:C(()=>[(m(!0),L(fe,null,De(f.files,y=>(m(),L("li",{key:y.uid||y.name,class:p([e(t).be("list","item"),e(t).is(y.status),{focusing:w.value}]),tabindex:"0",onKeydown:Me(F=>!f.disabled&&h(y),["delete"]),onFocus:k[0]||(k[0]=F=>w.value=!0),onBlur:k[1]||(k[1]=F=>w.value=!1),onClick:k[2]||(k[2]=F=>w.value=!1)},[O(f.$slots,"default",{file:y},()=>[f.listType==="picture"||y.status!=="uploading"&&f.listType==="picture-card"?(m(),L("img",{key:0,class:p(e(t).be("list","item-thumbnail")),src:y.url,alt:""},null,10,is)):_("v-if",!0),y.status==="uploading"||f.listType!=="picture-card"?(m(),L("div",{key:1,class:p(e(t).be("list","item-info"))},[S("a",{class:p(e(t).be("list","item-name")),onClick:K(F=>f.handlePreview(y),["prevent"])},[b(e(P),{class:p(e(c).m("document"))},{default:C(()=>[b(e(pt))]),_:1},8,["class"]),S("span",{class:p(e(t).be("list","item-file-name"))},oe(y.name),3)],10,us),y.status==="uploading"?(m(),z(e(Jt),{key:0,type:f.listType==="picture-card"?"circle":"line","stroke-width":f.listType==="picture-card"?6:2,percentage:Number(y.percentage),style:H(f.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):_("v-if",!0)],2)):_("v-if",!0),S("label",{class:p(e(t).be("list","item-status-label"))},[f.listType==="text"?(m(),z(e(P),{key:0,class:p([e(c).m("upload-success"),e(c).m("circle-check")])},{default:C(()=>[b(e(Be))]),_:1},8,["class"])):["picture-card","picture"].includes(f.listType)?(m(),z(e(P),{key:1,class:p([e(c).m("upload-success"),e(c).m("check")])},{default:C(()=>[b(e(Ae))]),_:1},8,["class"])):_("v-if",!0)],2),f.disabled?_("v-if",!0):(m(),z(e(P),{key:2,class:p(e(c).m("close")),onClick:F=>h(y)},{default:C(()=>[b(e(me))]),_:2},1032,["class","onClick"])),_(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),_(" This is a bug which needs to be fixed "),_(" TODO: Fix the incorrect navigation interaction "),f.disabled?_("v-if",!0):(m(),L("i",{key:3,class:p(e(c).m("close-tip"))},oe(e(l)("el.upload.deleteTip")),3)),f.listType==="picture-card"?(m(),L("span",{key:4,class:p(e(t).be("list","item-actions"))},[S("span",{class:p(e(t).be("list","item-preview")),onClick:F=>f.handlePreview(y)},[b(e(P),{class:p(e(c).m("zoom-in"))},{default:C(()=>[b(e(ve))]),_:1},8,["class"])],10,ds),f.disabled?_("v-if",!0):(m(),L("span",{key:0,class:p(e(t).be("list","item-delete")),onClick:F=>h(y)},[b(e(P),{class:p(e(c).m("delete"))},{default:C(()=>[b(e(je))]),_:1},8,["class"])],10,cs))],2)):_("v-if",!0)])],42,rs))),128)),O(f.$slots,"append")]),_:3},8,["class","name"]))}});var Te=te(ps,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-list.vue"]]);const ms=J({disabled:{type:Boolean,default:!1}}),vs={file:a=>vt(a)},gs=["onDrop","onDragover"],Xe="ElUploadDrag",ys=M({name:Xe}),hs=M({...ys,props:ms,emits:vs,setup(a,{emit:n}){const l=a,t=gt(xe);t||ye(Xe,"usage: <el-upload><el-upload-dragger /></el-upload>");const c=G("upload"),v=W(!1),w=f=>{if(l.disabled)return;v.value=!1;const k=Array.from(f.dataTransfer.files),y=t.accept.value;if(!y){n("file",k);return}const F=k.filter(r=>{const{type:s,name:o}=r,u=o.includes(".")?`.${o.split(".").pop()}`:"",$=s.replace(/\/.*$/,"");return y.split(",").map(d=>d.trim()).filter(d=>d).some(d=>d.startsWith(".")?u===d:/\/\*$/.test(d)?$===d.replace(/\/\*$/,""):/^[^/]+\/[^/]+$/.test(d)?s===d:!1)});n("file",F)},h=()=>{l.disabled||(v.value=!0)};return(f,k)=>(m(),L("div",{class:p([e(c).b("dragger"),e(c).is("dragover",v.value)]),onDrop:K(w,["prevent"]),onDragover:K(h,["prevent"]),onDragleave:k[0]||(k[0]=K(y=>v.value=!1,["prevent"]))},[O(f.$slots,"default")],42,gs))}});var bs=te(hs,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-dragger.vue"]]);const ks=J({...qe,beforeUpload:{type:R(Function),default:N},onRemove:{type:R(Function),default:N},onStart:{type:R(Function),default:N},onSuccess:{type:R(Function),default:N},onProgress:{type:R(Function),default:N},onError:{type:R(Function),default:N},onExceed:{type:R(Function),default:N}}),ws=["onKeydown"],$s=["name","multiple","accept"],_s=M({name:"ElUploadContent",inheritAttrs:!1}),Cs=M({..._s,props:ks,setup(a,{expose:n}){const l=a,t=G("upload"),c=ie({}),v=ie(),w=s=>{if(s.length===0)return;const{autoUpload:o,limit:u,fileList:$,multiple:d,onStart:B,onExceed:i}=l;if(u&&$.length+s.length>u){i(s,$);return}d||(s=s.slice(0,1));for(const U of s){const A=U;A.uid=pe(),B(A),o&&h(A)}},h=async s=>{if(v.value.value="",!l.beforeUpload)return f(s);let o;try{o=await l.beforeUpload(s)}catch{o=!1}if(o===!1){l.onRemove(s);return}let u=s;o instanceof Blob&&(o instanceof File?u=o:u=new File([o],s.name,{type:s.type})),f(Object.assign(u,{uid:s.uid}))},f=s=>{const{headers:o,data:u,method:$,withCredentials:d,name:B,action:i,onProgress:U,onSuccess:A,onError:D,httpRequest:V}=l,{uid:se}=s,ae={headers:o||{},withCredentials:d,file:s,data:u,method:$,filename:B,action:i,onProgress:Z=>{U(Z,s)},onSuccess:Z=>{A(Z,s),delete c.value[se]},onError:Z=>{D(Z,s),delete c.value[se]}},ne=V(ae);c.value[se]=ne,ne instanceof Promise&&ne.then(ae.onSuccess,ae.onError)},k=s=>{const o=s.target.files;!o||w(Array.from(o))},y=()=>{l.disabled||(v.value.value="",v.value.click())},F=()=>{y()};return n({abort:s=>{yt(c.value).filter(s?([u])=>String(s.uid)===u:()=>!0).forEach(([u,$])=>{$ instanceof XMLHttpRequest&&$.abort(),delete c.value[u]})},upload:h}),(s,o)=>(m(),L("div",{class:p([e(t).b(),e(t).m(s.listType),e(t).is("drag",s.drag)]),tabindex:"0",onClick:y,onKeydown:Me(K(F,["self"]),["enter","space"])},[s.drag?(m(),z(bs,{key:0,disabled:s.disabled,onFile:w},{default:C(()=>[O(s.$slots,"default")]),_:3},8,["disabled"])):O(s.$slots,"default",{key:1}),S("input",{ref_key:"inputRef",ref:v,class:p(e(t).e("input")),name:s.name,multiple:s.multiple,accept:s.accept,type:"file",onChange:k,onClick:o[0]||(o[0]=K(()=>{},["stop"]))},null,42,$s)],42,ws))}});var Fe=te(Cs,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-content.vue"]]);const Ie="ElUpload",Es=a=>{var n;(n=a.url)!=null&&n.startsWith("blob:")&&URL.revokeObjectURL(a.url)},Ss=(a,n)=>{const l=ht(a,"fileList",void 0,{passive:!0}),t=r=>l.value.find(s=>s.uid===r.uid);function c(r){var s;(s=n.value)==null||s.abort(r)}function v(r=["ready","uploading","success","fail"]){l.value=l.value.filter(s=>!r.includes(s.status))}const w=(r,s)=>{const o=t(s);!o||(console.error(r),o.status="fail",l.value.splice(l.value.indexOf(o),1),a.onError(r,o,l.value),a.onChange(o,l.value))},h=(r,s)=>{const o=t(s);!o||(a.onProgress(r,o,l.value),o.status="uploading",o.percentage=Math.round(r.percent))},f=(r,s)=>{const o=t(s);!o||(o.status="success",o.response=r,a.onSuccess(r,o,l.value),a.onChange(o,l.value))},k=r=>{ze(r.uid)&&(r.uid=pe());const s={name:r.name,percentage:0,status:"ready",size:r.size,raw:r,uid:r.uid};if(a.listType==="picture-card"||a.listType==="picture")try{s.url=URL.createObjectURL(r)}catch(o){bt(Ie,o.message),a.onError(o,s,l.value)}l.value=[...l.value,s],a.onChange(s,l.value)},y=async r=>{const s=r instanceof File?t(r):r;s||ye(Ie,"file to be removed not found");const o=u=>{c(u);const $=l.value;$.splice($.indexOf(u),1),a.onRemove(u,$),Es(u)};a.beforeRemove?await a.beforeRemove(s,l.value)!==!1&&o(s):o(s)};function F(){l.value.filter(({status:r})=>r==="ready").forEach(({raw:r})=>{var s;return r&&((s=n.value)==null?void 0:s.upload(r))})}return ue(()=>a.listType,r=>{r!=="picture-card"&&r!=="picture"||(l.value=l.value.map(s=>{const{raw:o,url:u}=s;if(!u&&o)try{s.url=URL.createObjectURL(o)}catch($){a.onError($,s,l.value)}return s}))}),ue(l,r=>{for(const s of r)s.uid||(s.uid=pe()),s.status||(s.status="success")},{immediate:!0,deep:!0}),{uploadFiles:l,abort:c,clearFiles:v,handleError:w,handleProgress:h,handleStart:k,handleSuccess:f,handleRemove:y,submit:F}},Rs=M({name:"ElUpload"}),Ls=M({...Rs,props:ns,setup(a,{expose:n}){const l=a,t=kt(),c=wt(),v=ie(),{abort:w,submit:h,clearFiles:f,uploadFiles:k,handleStart:y,handleError:F,handleRemove:r,handleSuccess:s,handleProgress:o}=Ss(l,v),u=T(()=>l.listType==="picture-card"),$=T(()=>({...l,fileList:k.value,onStart:y,onProgress:o,onSuccess:s,onError:F,onRemove:r}));return $t(()=>{k.value.forEach(({url:d})=>{d!=null&&d.startsWith("blob:")&&URL.revokeObjectURL(d)})}),_t(xe,{accept:Ct(l,"accept")}),n({abort:w,submit:h,clearFiles:f,handleStart:y,handleRemove:r}),(d,B)=>(m(),L("div",null,[e(u)&&d.showFileList?(m(),z(Te,{key:0,disabled:e(c),"list-type":d.listType,files:e(k),"handle-preview":d.onPreview,onRemove:e(r)},Ee({append:C(()=>[b(Fe,Se({ref_key:"uploadRef",ref:v},e($)),{default:C(()=>[e(t).trigger?O(d.$slots,"trigger",{key:0}):_("v-if",!0),!e(t).trigger&&e(t).default?O(d.$slots,"default",{key:1}):_("v-if",!0)]),_:3},16)]),_:2},[d.$slots.file?{name:"default",fn:C(({file:i})=>[O(d.$slots,"file",{file:i})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):_("v-if",!0),!e(u)||e(u)&&!d.showFileList?(m(),z(Fe,Se({key:1,ref_key:"uploadRef",ref:v},e($)),{default:C(()=>[e(t).trigger?O(d.$slots,"trigger",{key:0}):_("v-if",!0),!e(t).trigger&&e(t).default?O(d.$slots,"default",{key:1}):_("v-if",!0)]),_:3},16)):_("v-if",!0),d.$slots.trigger?O(d.$slots,"default",{key:2}):_("v-if",!0),O(d.$slots,"tip"),!e(u)&&d.showFileList?(m(),z(Te,{key:3,disabled:e(c),"list-type":d.listType,files:e(k),"handle-preview":d.onPreview,onRemove:e(r)},Ee({_:2},[d.$slots.file?{name:"default",fn:C(({file:i})=>[O(d.$slots,"file",{file:i})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):_("v-if",!0)]))}});var Ts=te(Ls,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload.vue"]]);const Fs=ge(Ts),Oe=a=>Et.post("/upload",{file:a}),he=a=>(Ft("data-v-d45f6e47"),a=a(),It(),a),Is={class:"el-upload__text"},Os=["src"],Ps=he(()=>S("span",null,"\u7F16\u8F91",-1)),Ns=he(()=>S("span",null,"\u67E5\u770B",-1)),Us=he(()=>S("span",null,"\u5220\u9664",-1)),Ds={class:"el-upload__tip"},Bs=M({__name:"index",props:{width:{default:"140px"},height:{default:"140px"},borderRadius:{default:"50%"},message:{default:"\u8BF7\u9009\u62E9\u56FE\u7247\u4E0A\u4F20"},warn:null,disabled:{type:Boolean,default:!1},limitSize:{default:4*1024*1024},limitNums:{default:1},image:null},setup(a){const n=a;Tt(o=>({"11d881bf":e(w),b993adc6:a.width,ac7ffea0:a.height,"2498e0a7":a.borderRadius,f369ded6:e(v).borderColor,"1875c298":e(v).cursor}));const l=`id_${Date.now()}`,t=W(n.image?[n.image]:[]),c=T(()=>t.value.map(o=>o.url)),v=T(()=>n.disabled?{cursor:"no-drop",borderColor:"var(--el-border-color-darker)"}:{cursor:"pointer",borderColor:"var(--el-primary-color)"}),w=T(()=>t.value.length===n.limitNums?"none":"flex"),h=(o,u)=>{t.value.length=0,t.value.push({url:o.url,name:o.name})},f=async(o,u)=>{const{name:$}=o[0],d=URL.createObjectURL(o[0]);t.value.length=0,t.value.push({url:d,name:$});const B=await Oe("demo");Re({message:B.message,type:"success"})},k=W(!1),y=()=>{k.value=!k.value},F=()=>{document.querySelector(`#${l} .el-upload__input`).click()},r=()=>{t.value.pop()},s=async o=>{await Oe("demo"),Re({message:o.message,type:"success"})};return(o,u)=>{const $=P,d=Fs,B=xt;return m(),L("div",{class:"upload-box",id:l},[b(d,{class:"avatar-uploader","file-list":t.value,"onUpdate:file-list":u[1]||(u[1]=i=>t.value=i),action:"/api/upload","list-type":"picture-card",accept:"image/jpeg,image/jpeg,image/png",disabled:a.disabled,limit:a.limitNums,"on-change":h,"on-exceed":f,"on-success":s},{file:C(()=>[t.value.length?(m(),L("img",{key:0,class:"upload-image",src:t.value[0].url},null,8,Os)):_("",!0),t.value.length?(m(),L("div",{key:1,class:"upload-handle",onClick:u[0]||(u[0]=K(()=>{},["stop"]))},[a.disabled?_("",!0):(m(),L("div",{key:0,class:"handle-icon",onClick:F},[b($,null,{default:C(()=>[b(e(St))]),_:1}),Ps])),S("div",{class:"handle-icon",onClick:y},[b($,null,{default:C(()=>[b(e(ve))]),_:1}),Ns]),a.disabled?_("",!0):(m(),L("div",{key:1,class:"handle-icon",onClick:r},[b($,null,{default:C(()=>[b(e(je))]),_:1}),Us]))])):_("",!0)]),default:C(()=>[S("div",Is,[b($,{class:"el-icon--upload"},{default:C(()=>[b(e(Rt))]),_:1}),Lt(oe(a.message),1)])]),_:1},8,["file-list","disabled","limit"]),S("div",Ds,[O(o.$slots,"tip",{},void 0,!0)]),k.value?(m(),z(B,{key:0,onClose:y,"url-list":e(c)},null,8,["url-list"])):_("",!0)])}}}),Ms=Ot(Bs,[["__scopeId","data-v-d45f6e47"]]);export{Ms as default};
