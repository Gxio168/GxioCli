import{aJ as Xe,as as He,b as te,g as T,aj as ie,ai as Oe,d as x,bi as $e,bj as We,bk as Ke,u as Q,aF as Ye,r as X,bl as Ge,ak as ue,H as N,z as oe,ae as Ze,o as Je,a as v,k as B,B as h,w as E,j as C,n as m,f as e,P as K,F as ee,A as $,E as U,aN as ve,c as I,G as pe,bm as Qe,bn as et,bo as tt,bp as ge,l as Pe,bq as st,br as at,C as Ne,ap as nt,aq as ot,e as D,a4 as lt,af as rt,_ as ne,au as re,aA as ae,bs as it,s as ye,bt as ut,bu as De,ar as dt,bv as Ue,ax as ct,a7 as Ce,m as le,a6 as A,ac as Ae,bw as ft,bx as Be,T as pt,a0 as mt,h as vt,by as gt,bz as yt,L as bt,K as ht,at as kt,p as wt,R as _t,ad as Ee,ab as Se,bA as Re,bB as $t,bC as Ct,bD as Et,a5 as St,aR as Rt,aS as Ft}from"./index.d46c8804.js";/* empty css                */import{t as be,d as Tt}from"./error.db406747.js";import{i as ze}from"./isNil.b8a77b53.js";import{u as xe}from"./index.5dfa3775.js";import{d as Lt}from"./debounce.775a9955.js";import{_ as It}from"./_plugin-vue_export-helper.cdc0426e.js";var Ot="Expected a function";function fe(a,n,o){var s=!0,f=!0;if(typeof a!="function")throw new TypeError(Ot);return Xe(o)&&(s="leading"in o?!!o.leading:s,f="trailing"in o?!!o.trailing:f),Lt(a,n,{leading:s,maxWait:n,trailing:f})}const Pt=()=>He&&/firefox/i.test(window.navigator.userAgent),Me=Symbol("uploadContextKey"),Nt=te({urlList:{type:T(Array),default:()=>ie([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),Dt={close:()=>!0,switch:a=>Oe(a)},Ut=["src"],At=x({name:"ElImageViewer"}),Bt=x({...At,props:Nt,emits:Dt,setup(a,{expose:n,emit:o}){const s=a,f={CONTAIN:{name:"contain",icon:$e(We)},ORIGINAL:{name:"original",icon:$e(Ke)}},p=Pt()?"DOMMouseScroll":"mousewheel",{t:w}=xe(),b=Q("image-viewer"),{nextZIndex:d}=Ye(),_=X(),y=X([]),L=Ge(),r=X(!0),t=X(s.initialIndex),l=ue(f.CONTAIN),u=X({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),S=N(()=>{const{urlList:g}=s;return g.length<=1}),c=N(()=>t.value===0),z=N(()=>t.value===s.urlList.length-1),i=N(()=>s.urlList[t.value]),k=N(()=>{const{scale:g,deg:R,offsetX:P,offsetY:V,enableTransition:H}=u.value;let q=P/g,W=V/g;switch(R%360){case 90:case-270:[q,W]=[W,-q];break;case 180:case-180:[q,W]=[-q,-W];break;case 270:case-90:[q,W]=[-W,q];break}const se={transform:`scale(${g}) rotate(${R}deg) translate(${q}px, ${W}px)`,transition:H?"transform .3s":""};return l.value.name===f.CONTAIN.name&&(se.maxWidth=se.maxHeight="100%"),se}),F=N(()=>Oe(s.zIndex)?s.zIndex:d());function O(){G(),o("close")}function M(){const g=fe(P=>{switch(P.code){case ae.esc:s.closeOnPressEscape&&O();break;case ae.space:ke();break;case ae.left:we();break;case ae.up:Y("zoomIn");break;case ae.right:_e();break;case ae.down:Y("zoomOut");break}}),R=fe(P=>{(P.wheelDelta?P.wheelDelta:-P.detail)>0?Y("zoomIn",{zoomRate:1.2,enableTransition:!1}):Y("zoomOut",{zoomRate:1.2,enableTransition:!1})});L.run(()=>{re(document,"keydown",g),re(document,p,R)})}function G(){L.stop()}function j(){r.value=!1}function Z(g){r.value=!1,g.target.alt=w("el.image.error")}function J(g){if(r.value||g.button!==0||!_.value)return;u.value.enableTransition=!1;const{offsetX:R,offsetY:P}=u.value,V=g.pageX,H=g.pageY,q=fe(se=>{u.value={...u.value,offsetX:R+se.pageX-V,offsetY:P+se.pageY-H}}),W=re(document,"mousemove",q);re(document,"mouseup",()=>{W()}),g.preventDefault()}function he(){u.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ke(){if(r.value)return;const g=it(f),R=Object.values(f),P=l.value.name,H=(R.findIndex(q=>q.name===P)+1)%g.length;l.value=f[g[H]],he()}function ce(g){const R=s.urlList.length;t.value=(g+R)%R}function we(){c.value&&!s.infinite||ce(t.value-1)}function _e(){z.value&&!s.infinite||ce(t.value+1)}function Y(g,R={}){if(r.value)return;const{zoomRate:P,rotateDeg:V,enableTransition:H}={zoomRate:1.4,rotateDeg:90,enableTransition:!0,...R};switch(g){case"zoomOut":u.value.scale>.2&&(u.value.scale=Number.parseFloat((u.value.scale/P).toFixed(3)));break;case"zoomIn":u.value.scale<7&&(u.value.scale=Number.parseFloat((u.value.scale*P).toFixed(3)));break;case"clockwise":u.value.deg+=V;break;case"anticlockwise":u.value.deg-=V;break}u.value.enableTransition=H}return oe(i,()=>{Ze(()=>{const g=y.value[0];g!=null&&g.complete||(r.value=!0)})}),oe(t,g=>{he(),o("switch",g)}),Je(()=>{var g,R;M(),(R=(g=_.value)==null?void 0:g.focus)==null||R.call(g)}),n({setActiveItem:ce}),(g,R)=>(v(),B(rt,{to:"body",disabled:!g.teleported},[h(lt,{name:"viewer-fade",appear:""},{default:E(()=>[C("div",{ref_key:"wrapper",ref:_,tabindex:-1,class:m(e(b).e("wrapper")),style:K({zIndex:e(F)})},[C("div",{class:m(e(b).e("mask")),onClick:R[0]||(R[0]=ee(P=>g.hideOnClickModal&&O(),["self"]))},null,2),$(" CLOSE "),C("span",{class:m([e(b).e("btn"),e(b).e("close")]),onClick:O},[h(e(U),null,{default:E(()=>[h(e(ve))]),_:1})],2),$(" ARROW "),e(S)?$("v-if",!0):(v(),I(pe,{key:0},[C("span",{class:m([e(b).e("btn"),e(b).e("prev"),e(b).is("disabled",!g.infinite&&e(c))]),onClick:we},[h(e(U),null,{default:E(()=>[h(e(Qe))]),_:1})],2),C("span",{class:m([e(b).e("btn"),e(b).e("next"),e(b).is("disabled",!g.infinite&&e(z))]),onClick:_e},[h(e(U),null,{default:E(()=>[h(e(et))]),_:1})],2)],64)),$(" ACTIONS "),C("div",{class:m([e(b).e("btn"),e(b).e("actions")])},[C("div",{class:m(e(b).e("actions__inner"))},[h(e(U),{onClick:R[1]||(R[1]=P=>Y("zoomOut"))},{default:E(()=>[h(e(tt))]),_:1}),h(e(U),{onClick:R[2]||(R[2]=P=>Y("zoomIn"))},{default:E(()=>[h(e(ge))]),_:1}),C("i",{class:m(e(b).e("actions__divider"))},null,2),h(e(U),{onClick:ke},{default:E(()=>[(v(),B(Pe(e(l).icon)))]),_:1}),C("i",{class:m(e(b).e("actions__divider"))},null,2),h(e(U),{onClick:R[3]||(R[3]=P=>Y("anticlockwise"))},{default:E(()=>[h(e(st))]),_:1}),h(e(U),{onClick:R[4]||(R[4]=P=>Y("clockwise"))},{default:E(()=>[h(e(at))]),_:1})],2)],2),$(" CANVAS "),C("div",{class:m(e(b).e("canvas"))},[(v(!0),I(pe,null,Ne(g.urlList,(P,V)=>nt((v(),I("img",{ref_for:!0,ref:H=>y.value[V]=H,key:P,src:P,style:K(e(k)),class:m(e(b).e("img")),onLoad:j,onError:Z,onMousedown:J},null,46,Ut)),[[ot,V===t.value]])),128))],2),D(g.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var zt=ne(Bt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const xt=ye(zt),Mt=te({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:a=>a>=0&&a<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:{type:Boolean,default:!1},duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:T(String),default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:T([String,Array,Function]),default:""},format:{type:T(Function),default:a=>`${a}%`}}),jt=["aria-valuenow"],Vt={viewBox:"0 0 100 100"},qt=["d","stroke","stroke-width"],Xt=["d","stroke","opacity","stroke-linecap","stroke-width"],Ht={key:0},Wt=x({name:"ElProgress"}),Kt=x({...Wt,props:Mt,setup(a){const n=a,o={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},s=Q("progress"),f=N(()=>({width:`${n.percentage}%`,animationDuration:`${n.duration}s`,backgroundColor:z(n.percentage)})),p=N(()=>(n.strokeWidth/n.width*100).toFixed(1)),w=N(()=>["circle","dashboard"].includes(n.type)?Number.parseInt(`${50-Number.parseFloat(p.value)/2}`,10):0),b=N(()=>{const i=w.value,k=n.type==="dashboard";return`
          M 50 50
          m 0 ${k?"":"-"}${i}
          a ${i} ${i} 0 1 1 0 ${k?"-":""}${i*2}
          a ${i} ${i} 0 1 1 0 ${k?"":"-"}${i*2}
          `}),d=N(()=>2*Math.PI*w.value),_=N(()=>n.type==="dashboard"?.75:1),y=N(()=>`${-1*d.value*(1-_.value)/2}px`),L=N(()=>({strokeDasharray:`${d.value*_.value}px, ${d.value}px`,strokeDashoffset:y.value})),r=N(()=>({strokeDasharray:`${d.value*_.value*(n.percentage/100)}px, ${d.value}px`,strokeDashoffset:y.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),t=N(()=>{let i;return n.color?i=z(n.percentage):i=o[n.status]||o.default,i}),l=N(()=>n.status==="warning"?ut:n.type==="line"?n.status==="success"?De:dt:n.status==="success"?Ue:ve),u=N(()=>n.type==="line"?12+n.strokeWidth*.4:n.width*.111111+2),S=N(()=>n.format(n.percentage));function c(i){const k=100/i.length;return i.map((O,M)=>Ce(O)?{color:O,percentage:(M+1)*k}:O).sort((O,M)=>O.percentage-M.percentage)}const z=i=>{var k;const{color:F}=n;if(ct(F))return F(i);if(Ce(F))return F;{const O=c(F);for(const M of O)if(M.percentage>i)return M.color;return(k=O[O.length-1])==null?void 0:k.color}};return(i,k)=>(v(),I("div",{class:m([e(s).b(),e(s).m(i.type),e(s).is(i.status),{[e(s).m("without-text")]:!i.showText,[e(s).m("text-inside")]:i.textInside}]),role:"progressbar","aria-valuenow":i.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[i.type==="line"?(v(),I("div",{key:0,class:m(e(s).b("bar"))},[C("div",{class:m(e(s).be("bar","outer")),style:K({height:`${i.strokeWidth}px`})},[C("div",{class:m([e(s).be("bar","inner"),{[e(s).bem("bar","inner","indeterminate")]:i.indeterminate}]),style:K(e(f))},[(i.showText||i.$slots.default)&&i.textInside?(v(),I("div",{key:0,class:m(e(s).be("bar","innerText"))},[D(i.$slots,"default",{percentage:i.percentage},()=>[C("span",null,le(e(S)),1)])],2)):$("v-if",!0)],6)],6)],2)):(v(),I("div",{key:1,class:m(e(s).b("circle")),style:K({height:`${i.width}px`,width:`${i.width}px`})},[(v(),I("svg",Vt,[C("path",{class:m(e(s).be("circle","track")),d:e(b),stroke:`var(${e(s).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-width":e(p),fill:"none",style:K(e(L))},null,14,qt),C("path",{class:m(e(s).be("circle","path")),d:e(b),stroke:e(t),fill:"none",opacity:i.percentage?1:0,"stroke-linecap":i.strokeLinecap,"stroke-width":e(p),style:K(e(r))},null,14,Xt)]))],6)),(i.showText||i.$slots.default)&&!i.textInside?(v(),I("div",{key:2,class:m(e(s).e("text")),style:K({fontSize:`${e(u)}px`})},[D(i.$slots,"default",{percentage:i.percentage},()=>[i.status?(v(),B(e(U),{key:1},{default:E(()=>[(v(),B(Pe(e(l))))]),_:1})):(v(),I("span",Ht,le(e(S)),1))])],6)):$("v-if",!0)],10,jt))}});var Yt=ne(Kt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/progress/src/progress.vue"]]);const Gt=ye(Yt),Zt="ElUpload";class Jt extends Error{constructor(n,o,s,f){super(n),this.name="UploadAjaxError",this.status=o,this.method=s,this.url=f}}function Fe(a,n,o){let s;return o.response?s=`${o.response.error||o.response}`:o.responseText?s=`${o.responseText}`:s=`fail to ${n.method} ${a} ${o.status}`,new Jt(s,o.status,n.method,a)}function Qt(a){const n=a.responseText||a.response;if(!n)return n;try{return JSON.parse(n)}catch{return n}}const es=a=>{typeof XMLHttpRequest>"u"&&be(Zt,"XMLHttpRequest is undefined");const n=new XMLHttpRequest,o=a.action;n.upload&&n.upload.addEventListener("progress",p=>{const w=p;w.percent=p.total>0?p.loaded/p.total*100:0,a.onProgress(w)});const s=new FormData;if(a.data)for(const[p,w]of Object.entries(a.data))Array.isArray(w)?s.append(p,...w):s.append(p,w);s.append(a.filename,a.file,a.file.name),n.addEventListener("error",()=>{a.onError(Fe(o,a,n))}),n.addEventListener("load",()=>{if(n.status<200||n.status>=300)return a.onError(Fe(o,a,n));a.onSuccess(Qt(n))}),n.open(a.method,o,!0),a.withCredentials&&"withCredentials"in n&&(n.withCredentials=!0);const f=a.headers||{};if(f instanceof Headers)f.forEach((p,w)=>n.setRequestHeader(w,p));else for(const[p,w]of Object.entries(f))ze(w)||n.setRequestHeader(p,String(w));return n.send(s),n},je=["text","picture","picture-card"];let ts=1;const me=()=>Date.now()+ts++,Ve=te({action:{type:String,default:"#"},headers:{type:T(Object)},method:{type:String,default:"post"},data:{type:Object,default:()=>ie({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},type:{type:String,default:"select"},fileList:{type:T(Array),default:()=>ie([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:je,default:"text"},httpRequest:{type:T(Function),default:es},disabled:Boolean,limit:Number}),ss=te({...Ve,beforeUpload:{type:T(Function),default:A},beforeRemove:{type:T(Function)},onRemove:{type:T(Function),default:A},onChange:{type:T(Function),default:A},onPreview:{type:T(Function),default:A},onSuccess:{type:T(Function),default:A},onProgress:{type:T(Function),default:A},onError:{type:T(Function),default:A},onExceed:{type:T(Function),default:A}}),as=te({files:{type:T(Array),default:()=>ie([])},disabled:{type:Boolean,default:!1},handlePreview:{type:T(Function),default:A},listType:{type:String,values:je,default:"text"}}),ns={remove:a=>!!a},os=["onKeydown"],ls=["src"],rs=["onClick"],is=["onClick"],us=["onClick"],ds=x({name:"ElUploadList"}),cs=x({...ds,props:as,emits:ns,setup(a,{emit:n}){const{t:o}=xe(),s=Q("upload"),f=Q("icon"),p=Q("list"),w=X(!1),b=d=>{n("remove",d)};return(d,_)=>(v(),B(pt,{tag:"ul",class:m([e(s).b("list"),e(s).bm("list",d.listType),e(s).is("disabled",d.disabled)]),name:e(p).b()},{default:E(()=>[(v(!0),I(pe,null,Ne(d.files,y=>(v(),I("li",{key:y.uid||y.name,class:m([e(s).be("list","item"),e(s).is(y.status),{focusing:w.value}]),tabindex:"0",onKeydown:Ae(L=>!d.disabled&&b(y),["delete"]),onFocus:_[0]||(_[0]=L=>w.value=!0),onBlur:_[1]||(_[1]=L=>w.value=!1),onClick:_[2]||(_[2]=L=>w.value=!1)},[D(d.$slots,"default",{file:y},()=>[d.listType==="picture"||y.status!=="uploading"&&d.listType==="picture-card"?(v(),I("img",{key:0,class:m(e(s).be("list","item-thumbnail")),src:y.url,alt:""},null,10,ls)):$("v-if",!0),y.status==="uploading"||d.listType!=="picture-card"?(v(),I("div",{key:1,class:m(e(s).be("list","item-info"))},[C("a",{class:m(e(s).be("list","item-name")),onClick:ee(L=>d.handlePreview(y),["prevent"])},[h(e(U),{class:m(e(f).m("document"))},{default:E(()=>[h(e(ft))]),_:1},8,["class"]),C("span",{class:m(e(s).be("list","item-file-name"))},le(y.name),3)],10,rs),y.status==="uploading"?(v(),B(e(Gt),{key:0,type:d.listType==="picture-card"?"circle":"line","stroke-width":d.listType==="picture-card"?6:2,percentage:Number(y.percentage),style:K(d.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):$("v-if",!0)],2)):$("v-if",!0),C("label",{class:m(e(s).be("list","item-status-label"))},[d.listType==="text"?(v(),B(e(U),{key:0,class:m([e(f).m("upload-success"),e(f).m("circle-check")])},{default:E(()=>[h(e(De))]),_:1},8,["class"])):["picture-card","picture"].includes(d.listType)?(v(),B(e(U),{key:1,class:m([e(f).m("upload-success"),e(f).m("check")])},{default:E(()=>[h(e(Ue))]),_:1},8,["class"])):$("v-if",!0)],2),d.disabled?$("v-if",!0):(v(),B(e(U),{key:2,class:m(e(f).m("close")),onClick:L=>b(y)},{default:E(()=>[h(e(ve))]),_:2},1032,["class","onClick"])),$(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),$(" This is a bug which needs to be fixed "),$(" TODO: Fix the incorrect navigation interaction "),d.disabled?$("v-if",!0):(v(),I("i",{key:3,class:m(e(f).m("close-tip"))},le(e(o)("el.upload.deleteTip")),3)),d.listType==="picture-card"?(v(),I("span",{key:4,class:m(e(s).be("list","item-actions"))},[C("span",{class:m(e(s).be("list","item-preview")),onClick:L=>d.handlePreview(y)},[h(e(U),{class:m(e(f).m("zoom-in"))},{default:E(()=>[h(e(ge))]),_:1},8,["class"])],10,is),d.disabled?$("v-if",!0):(v(),I("span",{key:0,class:m(e(s).be("list","item-delete")),onClick:L=>b(y)},[h(e(U),{class:m(e(f).m("delete"))},{default:E(()=>[h(e(Be))]),_:1},8,["class"])],10,us))],2)):$("v-if",!0)])],42,os))),128)),D(d.$slots,"append")]),_:3},8,["class","name"]))}});var Te=ne(cs,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-list.vue"]]);const fs=te({disabled:{type:Boolean,default:!1}}),ps={file:a=>mt(a)},ms=["onDrop","onDragover"],qe="ElUploadDrag",vs=x({name:qe}),gs=x({...vs,props:fs,emits:ps,setup(a,{emit:n}){const o=a,s=vt(Me);s||be(qe,"usage: <el-upload><el-upload-dragger /></el-upload>");const f=Q("upload"),p=X(!1),w=d=>{if(o.disabled)return;p.value=!1;const _=Array.from(d.dataTransfer.files),y=s.accept.value;if(!y){n("file",_);return}const L=_.filter(r=>{const{type:t,name:l}=r,u=l.includes(".")?`.${l.split(".").pop()}`:"",S=t.replace(/\/.*$/,"");return y.split(",").map(c=>c.trim()).filter(c=>c).some(c=>c.startsWith(".")?u===c:/\/\*$/.test(c)?S===c.replace(/\/\*$/,""):/^[^/]+\/[^/]+$/.test(c)?t===c:!1)});n("file",L)},b=()=>{o.disabled||(p.value=!0)};return(d,_)=>(v(),I("div",{class:m([e(f).b("dragger"),e(f).is("dragover",p.value)]),onDrop:ee(w,["prevent"]),onDragover:ee(b,["prevent"]),onDragleave:_[0]||(_[0]=ee(y=>p.value=!1,["prevent"]))},[D(d.$slots,"default")],42,ms))}});var ys=ne(gs,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-dragger.vue"]]);const bs=te({...Ve,beforeUpload:{type:T(Function),default:A},onRemove:{type:T(Function),default:A},onStart:{type:T(Function),default:A},onSuccess:{type:T(Function),default:A},onProgress:{type:T(Function),default:A},onError:{type:T(Function),default:A},onExceed:{type:T(Function),default:A}}),hs=["onKeydown"],ks=["name","multiple","accept"],ws=x({name:"ElUploadContent",inheritAttrs:!1}),_s=x({...ws,props:bs,setup(a,{expose:n}){const o=a,s=Q("upload"),f=ue({}),p=ue(),w=t=>{if(t.length===0)return;const{autoUpload:l,limit:u,fileList:S,multiple:c,onStart:z,onExceed:i}=o;if(u&&S.length+t.length>u){i(t,S);return}c||(t=t.slice(0,1));for(const k of t){const F=k;F.uid=me(),z(F),l&&b(F)}},b=async t=>{if(p.value.value="",!o.beforeUpload)return d(t);let l;try{l=await o.beforeUpload(t)}catch{l=!1}if(l===!1){o.onRemove(t);return}let u=t;l instanceof Blob&&(l instanceof File?u=l:u=new File([l],t.name,{type:t.type})),d(Object.assign(u,{uid:t.uid}))},d=t=>{const{headers:l,data:u,method:S,withCredentials:c,name:z,action:i,onProgress:k,onSuccess:F,onError:O,httpRequest:M}=o,{uid:G}=t,j={headers:l||{},withCredentials:c,file:t,data:u,method:S,filename:z,action:i,onProgress:J=>{k(J,t)},onSuccess:J=>{F(J,t),delete f.value[G]},onError:J=>{O(J,t),delete f.value[G]}},Z=M(j);f.value[G]=Z,Z instanceof Promise&&Z.then(j.onSuccess,j.onError)},_=t=>{const l=t.target.files;!l||w(Array.from(l))},y=()=>{o.disabled||(p.value.value="",p.value.click())},L=()=>{y()};return n({abort:t=>{gt(f.value).filter(t?([u])=>String(t.uid)===u:()=>!0).forEach(([u,S])=>{S instanceof XMLHttpRequest&&S.abort(),delete f.value[u]})},upload:b}),(t,l)=>(v(),I("div",{class:m([e(s).b(),e(s).m(t.listType),e(s).is("drag",t.drag)]),tabindex:"0",onClick:y,onKeydown:Ae(ee(L,["self"]),["enter","space"])},[t.drag?(v(),B(ys,{key:0,disabled:t.disabled,onFile:w},{default:E(()=>[D(t.$slots,"default")]),_:3},8,["disabled"])):D(t.$slots,"default",{key:1}),C("input",{ref_key:"inputRef",ref:p,class:m(e(s).e("input")),name:t.name,multiple:t.multiple,accept:t.accept,type:"file",onChange:_,onClick:l[0]||(l[0]=ee(()=>{},["stop"]))},null,42,ks)],42,hs))}});var Le=ne(_s,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-content.vue"]]);const Ie="ElUpload",$s=a=>{var n;(n=a.url)!=null&&n.startsWith("blob:")&&URL.revokeObjectURL(a.url)},Cs=(a,n)=>{const o=yt(a,"fileList",void 0,{passive:!0}),s=r=>o.value.find(t=>t.uid===r.uid);function f(r){var t;(t=n.value)==null||t.abort(r)}function p(r=["ready","uploading","success","fail"]){o.value=o.value.filter(t=>!r.includes(t.status))}const w=(r,t)=>{const l=s(t);!l||(console.error(r),l.status="fail",o.value.splice(o.value.indexOf(l),1),a.onError(r,l,o.value),a.onChange(l,o.value))},b=(r,t)=>{const l=s(t);!l||(a.onProgress(r,l,o.value),l.status="uploading",l.percentage=Math.round(r.percent))},d=(r,t)=>{const l=s(t);!l||(l.status="success",l.response=r,a.onSuccess(r,l,o.value),a.onChange(l,o.value))},_=r=>{ze(r.uid)&&(r.uid=me());const t={name:r.name,percentage:0,status:"ready",size:r.size,raw:r,uid:r.uid};if(a.listType==="picture-card"||a.listType==="picture")try{t.url=URL.createObjectURL(r)}catch(l){Tt(Ie,l.message),a.onError(l,t,o.value)}o.value=[...o.value,t],a.onChange(t,o.value)},y=async r=>{const t=r instanceof File?s(r):r;t||be(Ie,"file to be removed not found");const l=u=>{f(u);const S=o.value;S.splice(S.indexOf(u),1),a.onRemove(u,S),$s(u)};a.beforeRemove?await a.beforeRemove(t,o.value)!==!1&&l(t):l(t)};function L(){o.value.filter(({status:r})=>r==="ready").forEach(({raw:r})=>{var t;return r&&((t=n.value)==null?void 0:t.upload(r))})}return oe(()=>a.listType,r=>{r!=="picture-card"&&r!=="picture"||(o.value=o.value.map(t=>{const{raw:l,url:u}=t;if(!u&&l)try{t.url=URL.createObjectURL(l)}catch(S){a.onError(S,t,o.value)}return t}))}),oe(o,r=>{for(const t of r)t.uid||(t.uid=me()),t.status||(t.status="success")},{immediate:!0,deep:!0}),{uploadFiles:o,abort:f,clearFiles:p,handleError:w,handleProgress:b,handleStart:_,handleSuccess:d,handleRemove:y,submit:L}},Es=x({name:"ElUpload"}),Ss=x({...Es,props:ss,setup(a,{expose:n}){const o=a,s=bt(),f=ht(),p=ue(),{abort:w,submit:b,clearFiles:d,uploadFiles:_,handleStart:y,handleError:L,handleRemove:r,handleSuccess:t,handleProgress:l}=Cs(o,p),u=N(()=>o.listType==="picture-card"),S=N(()=>({...o,fileList:_.value,onStart:y,onProgress:l,onSuccess:t,onError:L,onRemove:r}));return kt(()=>{_.value.forEach(({url:c})=>{c!=null&&c.startsWith("blob:")&&URL.revokeObjectURL(c)})}),wt(Me,{accept:_t(o,"accept")}),n({abort:w,submit:b,clearFiles:d,handleStart:y,handleRemove:r}),(c,z)=>(v(),I("div",null,[e(u)&&c.showFileList?(v(),B(Te,{key:0,disabled:e(f),"list-type":c.listType,files:e(_),"handle-preview":c.onPreview,onRemove:e(r)},Ee({append:E(()=>[h(Le,Se({ref_key:"uploadRef",ref:p},e(S)),{default:E(()=>[e(s).trigger?D(c.$slots,"trigger",{key:0}):$("v-if",!0),!e(s).trigger&&e(s).default?D(c.$slots,"default",{key:1}):$("v-if",!0)]),_:3},16)]),_:2},[c.$slots.file?{name:"default",fn:E(({file:i})=>[D(c.$slots,"file",{file:i})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):$("v-if",!0),!e(u)||e(u)&&!c.showFileList?(v(),B(Le,Se({key:1,ref_key:"uploadRef",ref:p},e(S)),{default:E(()=>[e(s).trigger?D(c.$slots,"trigger",{key:0}):$("v-if",!0),!e(s).trigger&&e(s).default?D(c.$slots,"default",{key:1}):$("v-if",!0)]),_:3},16)):$("v-if",!0),c.$slots.trigger?D(c.$slots,"default",{key:2}):$("v-if",!0),D(c.$slots,"tip"),!e(u)&&c.showFileList?(v(),B(Te,{key:3,disabled:e(f),"list-type":c.listType,files:e(_),"handle-preview":c.onPreview,onRemove:e(r)},Ee({_:2},[c.$slots.file?{name:"default",fn:E(({file:i})=>[D(c.$slots,"file",{file:i})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):$("v-if",!0)]))}});var Rs=ne(Ss,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload.vue"]]);const Fs=ye(Rs);function Ts(a){return[a]}const de=a=>(Rt("data-v-bea1b576"),a=a(),Ft(),a),Ls=["id"],Is={class:"content"},Os=["src"],Ps={class:"mask"},Ns=de(()=>C("span",null,"\u7F16\u8F91",-1)),Ds=["onClick"],Us=de(()=>C("span",null,"\u67E5\u770B",-1)),As=["onClick"],Bs=de(()=>C("span",null,"\u5220\u9664",-1)),zs=de(()=>C("div",{class:"tip-text"},"\u8FD9\u91CC\u662F\u63D0\u793A\u6846",-1)),xs=x({__name:"index",props:{id:null,drag:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},type:{default:"avatar"},isRadius:{type:Boolean,default:!0},limitSize:{default:4*1024*1024},limitNums:{default:1},uploadStyle:{default:()=>({width:"140px",height:"140px"})},url:null,imageUrl:null,modelValue:null},emits:["update:modelValue"],setup(a,{expose:n,emit:o}){const s=a;St(k=>({"3523e607":e(b),"7c1055cd":a.uploadStyle.width,"27a92c00":a.uploadStyle.height,"142c4b94":e(_),"10a24d6a":e(y).cursor,a6830dfa:e(y).borderColor}));const p=X((k=>k===""?[]:typeof k=="string"?Ts(k).map(F=>({name:`text_${Date.now()}`,url:F})):k.map(F=>({name:`text_${Date.now()}`,url:F})))(s.imageUrl));oe(()=>p.value,k=>{o("update:modelValue",k)},{deep:!0});const w=s.type==="avatar"?"\u8BF7\u4E0A\u4F20\u5934\u50CF":"\u8BF7\u4E0A\u4F20\u56FE\u7247",b=s.isRadius?"50%":"8px",d=X([]),_=N(()=>p.value.length===s.limitNums?"none":"flex"),y=s.disabled?{cursor:"no-drop",borderColor:"var(--el-border-color-darker)"}:{cursor:"pointer",borderColor:"var(--el-color-primary);"},L=X(),r=()=>{},t=(k,F)=>{F.length>s.limitNums&&F.shift(),k.size>s.limitSize?(Re({type:"error",title:"\u6E29\u99A8\u63D0\u793A",message:"\u56FE\u7247\u8FC7\u5927!"}),z(k)):Re({type:"success",title:"\u6E29\u99A8\u63D0\u793A",message:"\u56FE\u7247\u4E0A\u4F20\u6210\u529F!"})},l=()=>{document.querySelector(`#${s.id} .el-upload__input`).dispatchEvent(new MouseEvent("click"))},u=X(!1),S=()=>{u.value=!u.value},c=k=>{d.value=[k.url],S()},z=k=>{const F=p.value.findIndex(O=>O.uid===k.uid);p.value.splice(F,1)};return n({handleUpload:()=>{L.value.submit()}}),(k,F)=>{const O=U,M=Fs,G=xt;return v(),I("span",{style:{display:"inline-block","text-align":"center"},id:a.id},[h(M,{ref_key:"uploadRef",ref:L,accept:"image/jpg,image/png,image/jpeg,image/gif",action:a.url,"list-type":"picture-card","auto-upload":!1,drag:a.drag,"file-list":p.value,"onUpdate:file-list":F[0]||(F[0]=j=>p.value=j),"before-upload":r,"on-change":t,disabled:a.disabled},{default:E(()=>[C("div",Is,[h(O,null,{default:E(()=>[a.type==="avatar"?(v(),B(e($t),{key:0})):(v(),B(e(Ct),{key:1}))]),_:1}),C("span",null,le(e(w)),1)])]),file:E(({file:j})=>[C("img",{src:j.url},null,8,Os),C("div",Ps,[!a.disabled&&a.limitNums===1?(v(),I("div",{key:0,onClick:l},[h(O,null,{default:E(()=>[h(e(Et))]),_:1}),Ns])):$("",!0),C("div",{onClick:Z=>c(j)},[h(O,null,{default:E(()=>[h(e(ge))]),_:1}),Us],8,Ds),a.disabled?$("",!0):(v(),I("div",{key:1,onClick:Z=>z(j)},[h(O,null,{default:E(()=>[h(e(Be))]),_:1}),Bs],8,As))])]),_:1},8,["action","drag","file-list","disabled"]),D(k.$slots,"tip",{},()=>[zs],!0),u.value?(v(),B(G,{key:0,onClose:S,"url-list":e(d)},null,8,["url-list"])):$("",!0)],8,Ls)}}});const Ks=It(xs,[["__scopeId","data-v-bea1b576"]]);export{Ks as default};
